<canvas id="canvas" width="400" height="400"> </canvas>
<script>
  window.onload = function() {
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    document.addEventListener("keydown", keyPush);
    setInterval(game, 1000 / 15);
  };

  xSnake = ySnake = 10;
  gridSize = tileCount = 20;
  xFood = yFood = 15;
  xVelocity = yVelocity = 0;
  trail = [];
  tail = 5;

  function game() {
    xSnake += xVelocity;
    ySnake += yVelocity;
    if (xSnake < 0) {
      xSnake = tileCount - 1;
    }
    if (xSnake > tileCount - 1) {
      xSnake = 0;
    }
    if (ySnake < 0) {
      ySnake = tileCount - 1;
    }
    if (ySnake > tileCount - 1) {
      ySnake = 0;
    }
    context.fillStyle = "black";
    context.fillRect(0, 0, canvas.width, canvas.height);

    context.fillStyle = "lime";
    for (var i = 0; i < trail.length; i++) {
      context.fillRect(
        trail[i].x * gridSize,
        trail[i].y * gridSize,
        gridSize - 2,
        gridSize - 2
      );
      if (trail[i].x == xSnake && trail[i].y == ySnake) {
        tail = 5;
      }
    }
    trail.push({ x: xSnake, y: ySnake });
    while (trail.length > tail) {
      trail.shift();
    }

    if (xFood == xSnake && yFood == ySnake) {
      tail++;
      xFood = Math.floor(Math.random() * tileCount);
      yFood = Math.floor(Math.random() * tileCount);
    }

    context.fillStyle = "red";
    context.fillRect(
      xFood * gridSize,
      yFood * gridSize,
      gridSize - 2,
      gridSize - 2
    );
  }
  function keyPush(event) {
    switch (event.keyCode) {
      case 37:
        xVelocity = -1;
        yVelocity = 0;
        break;
      case 38:
        xVelocity = 0;
        yVelocity = -1;
        break;
      case 39:
        xVelocity = 1;
        yVelocity = 0;
        break;
      case 40:
        xVelocity = 0;
        yVelocity = 1;
        break;
    }
  }
</script>
